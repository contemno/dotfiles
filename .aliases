#!/bin/bash

#######################################################
# Local AND Remote aliases
#
alias fuck='echo $(fc -ln -1) && sudo $(fc -ln -1)'
alias ll='ls -l --color=auto'
alias la='ls -la --color=auto'
alias ls='ls --color=auto'
alias ssh='sshrc'
alias mock='mock --dnf'
alias mkgrub='grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg'
alias git-walk='find . -name ".git" -type d -exec sh -c '\''( repo="$(dirname {})" && cd "$repo" && echo "$repo - $(git branch --color -vv)" && git status -s -uno)'\'' \;'
eval alias tmux="'tmux -f ${__TMUXRC}'" # __TMUXRC is in .common

# Please god help me remember dnf/yum
if hash dnf >/dev/null 2>&1; then
	alias dnf-repowhere='dnf repoquery --qf="%{name}-%{version}-%{release}.%{arch}\t%{reponame}"'
	alias yum='dnf'
elif hash yum >/dev/null 2>&1; then
	alias yum-repowhere='repoquery --qf="%{name}-%{version}-%{release}.%{arch}\t%{repoid}"'
	alias dnf='yum'
elif hash apt-get >/dev/null 2>&1; then
	echo "Debian, really? Idiot!"
fi

# Ok got me, not aliases but they act like ones
# Neat little script to upload files to hastebin.com
if hash curl >/dev/null 2>&1; then
	haste ()
	{
	    local S="http"
	    local H="hastebin.com"
	    local P=""
	    local SHP="${S}://${H}${P}/"
	    curl -X POST -s --data-binary @- "${SHP}documents" \
		| awk -F '"' '{print a$4}' a="${SHP}"
	}
fi

# Print what group a package is in
if hash dnf >/dev/null 2>&1; then
	dnf-groupfind() {
		sudo dnf group info '*' \
			| awk 	-v package="$1" \
				-v red="$(tput setaf 196)" \
				-v rst="$(tput sgr0)" \
				'
				BEGIN {
					FS=": "
					group_reg="^Group: "
					opt_reg="^ Optional Packages:"
				}
				$0 ~ group_reg { group=$2 }
				$0 ~ opt_reg { opt=group }
				$0 ~ "^[ ]*"package {
					name=$1
					found=1 
					gsub(" ","",name)
					if ( opt == group ) {
						print name,"-",group,red"- Optional"rst" ( add \"with-optional\" to dnf group install command )"
					} else {
						print name,"-",group
					}
				}
				END {
					if ( ! found ) { print red"Not found."rst } 
				}
				'
	}
fi
